[gcode_macro LOG_PLR_LAYER]
description: Save Z position for PLR (call from layer change gcode)
gcode:
  {% if printer.print_stats.state == "printing" %}
    {% set z = printer.toolhead.position.z|float %}
    SAVE_VARIABLE VARIABLE=plr_z VALUE={z}
  {% endif %}


[gcode_macro PLR_FLAG_SET]
gcode:
  SAVE_VARIABLE VARIABLE=plr_interrupted VALUE=True
  

[gcode_macro PLR_FLAG_CLEAR]
gcode:
  SAVE_VARIABLE VARIABLE=plr_interrupted VALUE=False

[gcode_macro PLR_SAVENAME]
gcode:
  {% set fname = printer.print_stats.filename|default("") %}
  SAVE_VARIABLE VARIABLE=plr_file VALUE="'{fname}'"
